/* 
 * Makefile for the FX (file exchange) protocol
 *
 * $Author: ghudson $
 * $Id: Imakefile,v 1.6 1997-11-14 22:25:50 ghudson Exp $
 *
 *
 * Copyright 1989, 1990 by the Massachusetts Institute of Technology.
 *
 * For copying and distribution information, please see the file
 * <mit-copyright.h>.
 *
 */

AnsiCC()

RPCGEN=rpcgen -C
INCLUDES = -I../include

/* Define KERBEROS for Kerberos support */
DEFKRB = -DKERBEROS

/* Define HESIOD for Hesiod support (not meaningful in protocol) */
/*#DEFHES = -DHESIOD */

/* Define MULTI for multiple server support */
DEFMULTI = -DMULTI

/* 
 * Define DEBUG for command debugging messages
 * Define DEBUGDB for db debugging messages
 * Define DEBUGMULTI for debugging multiple server support
 * Define MALLOC_LEAK for malloc scribble checking and function tracing
*/
DEFDEBUG = -DMALLOC_LEAK

DEFINES = ${INCLUDES} ${DEFKRB} ${DEFHES} ${DEFMULTI} ${DEFDEBUG}

build_program(ansify,ansify.o,,)
all:: fx_prot_svc.o fx_prot_clnt.o fx_prot_xdr.o

fx_prot_svc.o: fx_prot_svc.c
fx_prot_clnt.o: fx_prot_clnt.c
fx_prot_xdr.o: fx_prot_xdr.c

fx_prot_svc.c fx_prot_clnt.c fx_prot_xdr.c: fx_prot.x
	${RPCGEN} fx_prot.x
	cat xdr_extras.c >> fx_prot_xdr.c
	${RPCGEN} -m -o fx_prot_svc.c fx_prot.x
	rm -f ../include/fx_prot.h
	mv fx_prot.h ../include/fx_prot.h

clean::
	rm -f *.o fx_prot_svc.c fx_prot_clnt.c fx_prot_xdr.c fx_prot.h
